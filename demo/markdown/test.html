<!DOCTYPE html>

<html lang="en">
<head>
    <title>Ace Markdown</title>

    <link rel="stylesheet" href="style.css" type="text/css" media="screen" charset="utf-8">
</head>
<body>
<div style="display: flex; gap: 10px">
    <div id="editor"></div>
    <div id="markdown-result" class="markdown-body"></div>
</div>


<!--DEVEL-->
<script type="text/javascript">
    var os = /os=(\w+)|$/.exec(location.search)[1];
    if (os) Object.defineProperty(navigator, "platform", {configurable:true, value: os});
</script>
<script src="../kitchen-sink/require.js" type="text/javascript"></script>
<script>
    // setup paths
    require.config({paths: { "ace" : "../../src"}});
    // load ace and extensions
    require(["ace/ace", "ace/mode/markdown", "markdown_renderer", "markdown_parser", "markdown_sync_controller"], function(ace, codeLens) {
        var config = require("ace/config");
        var net = require("ace/lib/net");
        config.setLoader(function(moduleName, cb) {
            require([moduleName], function(module) {
                cb(null, module);
            });
        });

        var markdownResult = document.getElementById("markdown-result");
        var editor = ace.edit("editor");

        var onResize = () => {
            var height = window.innerHeight + "px";
            var width = Math.floor(window.innerWidth / 2) + "px";
            editor.container.style.height = height;
            markdownResult.style.height = height;

            editor.container.style.width = width;
            markdownResult.style.width = width;

            editor.resize();
        }

        window.onresize = onResize;

        var MarkdownRenderer = require("markdown_renderer").MarkdownRenderer;
        var MarkdownSyncController = require("markdown_sync_controller").MarkdownSyncController;
        var markdownRenderer = new MarkdownRenderer();
        var markdownSyncController = new MarkdownSyncController();

        markdownRenderer.setEditor(editor);
        markdownRenderer.setResultHtml(markdownResult);
        markdownSyncController.init(markdownRenderer);

        net.get("../kitchen-sink/docs/markdown.md", function(result) {
            editor.setValue(result, -1);
        });

        onResize();
    });
</script>
</body>
</html>
